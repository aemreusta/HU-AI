# Orion VM - Penetration Test & Walkthrough (BBM456 - Hacettepe AI Eng.)

This repository contains files, notes, and a walkthrough for the "Orion" vulnerable virtual machine, completed as a project for the **BBM 456: Computer Networks and Security** course, Hacettepe University, Department of Artificial Intelligence Engineering, Spring 2025 semester.

The goal of this assignment was to identify vulnerabilities, capture three flags, and gain root access, with a specific focus on how the root password was obtained as per the instructor's guidelines.

## VM Overview

*   **Name:** Orion
*   **Source:** Provided as part of the BBM456 course assignment.
*   **Compatibility:** VMware (Workstation/Player/Fusion)
*   **Attacker VM:** Kali Linux

## Walkthrough Summary

1.  **Initial Reconnaissance:**
    *   IP Discovery (`nmap -sn`)
    *   Port Scanning (`nmap -sV -sC -p-`): Identified SSH (22), Apache (80), Nginx with Basic Auth (81).
    *   Web Enumeration (Port 80): `gobuster` found `/control.php`, `/control.txt`, `/outpost.jpeg`.

2.  **Gaining Initial Foothold (RCE as `www-data`):**
    *   Arbitrary File Write vulnerability in `/control.php` used to upload a PHP web shell (`shell.php`).
    *   RCE confirmed via `shell.php?cmd=id`.

3.  **Flag 1 & Flag 2 Discovery (as `www-data`):**
    *   **Flag 1 (`Flag{n0t r00t y3t}`):** Found encrypted in `/FLAG.txt` (root of filesystem), decrypted using a substitution cipher ("Solar Flare Encryption").
    *   **Flag 2 (`Flag{0ld_V3X_s3nd_s1gn4l}`):** Found in `/home/commandervex/FLAG.txt`.

4.  **User Pivoting (to `commandervex`):**
    *   Password `HumanityOutpost2049!` for `commandervex` identified (from SSH login banner / `~/.s3cr3t`).
    *   SSH'd into `commandervex@<orion_ip>`.

5.  **Privilege Escalation to Root (as `commandervex`):**
    *   Transferred and executed `linpeas.sh` to identify vulnerabilities.
    *   System found vulnerable to **CVE-2022-0847 (DirtyPipe)**.
    *   Downloaded and compiled a public exploit for DirtyPipe (e.g., `exploit-2.c` from AlexisAhmed's repository).
    *   Transferred and executed the compiled exploit on Orion.

6.  **Root Access & Flag 3:**
    *   Exploit successfully provided a root shell.
    *   **Root Password:** The exploit set the root password to `piped`. Verified with `su root`. This fulfilled the course requirement that the method of gaining root also determined the usable root password.
    *   **Flag 3 (`Flag{y0u_s4V3d_0r10n}`):** Found in `/root/FLAG.txt`.

## Tools Used

*   Nmap
*   Gobuster
*   cURL
*   [linPEAS](https://github.com/peass-ng/PEASS-ng)
*   [DirtyPipe Exploit (CVE-2022-0847)](https://github.com/AlexisAhmed/CVE-2022-0847-DirtyPipe-Exploits)
*   GCC (for compiling exploit)
*   SCP
*   SSH Client

## Key Vulnerabilities Exploited

*   Arbitrary File Write (leading to RCE)
*   Kernel Vulnerability: CVE-2022-0847 (DirtyPipe)

---

*This walkthrough documents the exploitation of a deliberately vulnerable machine for the BBM456 course project. All actions were performed in a controlled lab environment.*